# test_calibration

Программа для калибровки камеры, пример использования объекта `pbio::CameraCalibrator`.

Программа работает в двух режимах:

* `calibrate` – провести процесс калибровки
* `view` – просмотреть результат коррекции дисторции по результатам калибровки

Параметры запуска в режиме `calibrate`:

* путь до файла библиотеки `libfacerec.so` или `facerec.dll`
* путь до каталога *conf/facerec*
* id вебкамеры или url видеопотока
* желаемая ширина кадра
* желаемая высота кадра
* `calibrate`
* тип калибровочного шаблона (`acircles`, `circles` или `chessboard`)
* ширина калибровочного шаблона
* высота калибровочного шаблона
* путь до файла, в котором нужно сохранить откалиброванные параметры

Пример запуска из каталога *bin* в режиме `calibrate`:

* Linux: `./test_calibration ../lib/libfacerec.so ../conf/facerec/ 0 640 480 calibrate acircles 4 11 ./camparam.bin`
* Windows: `test_calibration facerec.dll ../conf/facerec/ 0 640 480 calibrate acircles 4 11 ./camparam.bin`

Для проведения калибровки необходимо распечатать калибровочный шаблон (см. [Калибровка камеры и коррекция дисторсии](../../development/camera_calibration.md)) и закрепить его на плоской поверхности, желательно черной. Рекомендуется использовать шаблон *asymmetric circles grid*. Затем перемещайте калибровочный шаблон или камеру, чтобы снять шаблон в различных позах и ориентациях. Программа выводит оценку покрытия пространства позиций и ориентаций шаблонов и выдает подсказку необходимой позиции шаблона. Затем нажмите клавишу `с` для калибровки. Это может занять около минуты, в это время работа программы приостанавливается.

В случае успешной калибровки программа выведет ошибку репроекции и выполнит коррекцию дисторсии кадров. Используйте клавиши `q` и `w` для изменения параметра коррекции дисторсии *alpha*. Нажмите клавишу `s` для сохранения откалиброванных параметров или снимите больше кадров и выполните калибровку ещё раз. 

Параметры запуска в режиме `view`:

* путь до файла библиотеки `libfacerec.so` или `facerec.dll`
* путь до каталога *conf/facerec*
* id вебкамеры или url видеопотока
* желаемая ширина кадра
* желаемая высота кадра
* `view`
* путь до файла, в котором были сохранены откалиброванные параметры

Пример запуска из каталога *bin* в режиме `view`:

* Linux: `./test_calibration ../lib/libfacerec.so ../conf/facerec/ 0 640 480 view ./camparam.bin`
* Windows: `test_calibration facerec.dll ../conf/facerec/ 0 640 480 view ./camparam.bin`

Используйте клавиши `q` и `w` для изменения параметра корректировки дисторсии *alpha*.

Исходный код: [test_calibration.cpp](../../../../examples/cpp/test_calibration/test_calibration.cpp)

Для сборки требуется библиотека OpenCV.
