# video_recognition_demo

Программа является примером использования `pbio::VideoWorker` и демонстрирует трекинг и идентификацию лиц на нескольких видеопотоках.

Для быстрого запуска сэмпла с параметрами по умолчанию и проверки распознавания лиц на Windows:

1. Создайте базу, которая будет использоваться при поиске лиц. Чтобы создать базу, перейдите в папку *bin/base* и создайте новую папку, например, *person0*. Поместите в папку фотографию человека, которого нужно найти в базе, а также создайте файл `name.txt`, который должен находиться в этой же папке и содержать имя человека латинскими буквами.

<p align="center">
<img width="250" src="../../../img/video_rec_base_folder.png"><br>
<b>Содержимое папки bin/base/person0</b>
</p>

2. Зайдите в папку *bin* и двойным левым щелчком мыши запустите скрипт `demo_web_m_last_v30.bat`, `demo_web_m_last_v300.bat`, `demo_web_m_last_v1000.bat` или `demo_web_m6v7.bat`. Не имеет принципиального значения, каким скриптом Вы запускаете данный сэмпл, поскольку они различаются только методом распознавания (9.30, 9.300, 9.1000 и 6.7 соответственно, более подробную информацию о методах см. в пункте [Идентификация лиц](../../development/face_identification.md)).

<p align="center">
<img width="200" src="../../../img/cpp_video_recognition.png"><br>
<b>Расположение C++ video_recognition_demo</b>
</p>

3. Результаты трекинга и идентификации отображаются в окнах (по одному на каждый источник). Найденные лица выделяются зеленым кругом. В правой верхней части окна отображаются результаты распознавания: слева – найденное лицо на видео, справа – лицо из базы и имя.

<p align="center">
<img width="700" src="../../../img/video_rec_demo_result.png"><br>
<b>Результат запуска C++ video_recognition_demo</b>
</p>

Также Вы можете запустить сэмпл `video_recognition_demo`, указав определенные параметры (например, в случае, если у вас есть онлайн-лицензия).

Параметры запуска:

* один или несколько источников, каждый источник - это число (номер вебкамеры) либо текст (URL видеопотока либо путь до видеофайла);
* и далее в произвольном порядке именованные параметры:
    * `config_dir` – путь до каталога *conf/facerec*
    * `dll_path` – путь до файла библиотеки `libfacerec.so` или `facerec.dll`
    * `database_dir` – путь до каталога с базой, в котором для каждого человека создан каталог, содержащий его фотографии и текстовый файл `name.txt`, содержащий его имя латиницей. Пример базы находится в *bin/base*
    * `frame_fps_limit` – ограничение FPS
    * `fullscreen` – полноэкранный режим
    * `license_dir` – путь до каталога с лицензией (укажите, если нужно изменить каталог по умолчанию `license`)
    * `vw_config_file` – имя конфигурационного файла `VideoWorker`
    * `method_config` – имя конфигурационного файла распознавателя
    * `recognition_distance_threshold` – порог распознавания (вещественное число)

Примеры скриптов запуска:

* Linux:
    * `demo_web_m_last_v30.sh` – запуск методом 9.30 с вебкамеры 0
    * `demo_web_m_last_v300.sh` – запуск методом 9.300 с вебкамеры 0
    * `demo_web_m_last_v1000.sh` – запуск методом 9.1000 с вебкамеры 0
    * `demo_web_m6v7.sh` – запуск методом 6.7 с вебкамеры 0

* Windows:
    * `demo_web_m_last_v30.bat` – запуск методом 9.30 с вебкамеры 0
    * `demo_web_m_last_v300.bat` – запуск методом 9.300 с вебкамеры 0
    * `demo_web_m_last_v1000.bat` – запуск методом 9.1000 с вебкамеры 0
    * `demo_web_m6v7.bat` – запуск методом 6.7 с вебкамеры 0

В консоли отображается статус загрузки базы и сообщения об ошибках при их возникновении.

Исходный код: [examples/cpp/video_recognition_demo](../../../../examples/cpp/video_recognition_demo)

Для сборки требуются библиотеки OpenCV и boost.
